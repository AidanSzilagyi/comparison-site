{% extends "./base.html" %}
{% block extra_head %}
    {% load static %}
    {% load mathfilters %}
    <link rel="stylesheet" href="{% static 'styles/list-info.css' %}">
    <div style="display: none;" id="list-slug">{{list.slug}}</div>
    <div style="display: none;" id="total-num-things">{{list.num_things}}</div>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Google+Sans+Code:ital,wght@0,300..800;1,300..800&family=Outfit:wght@100..900&display=swap" rel="stylesheet">
    <script src="{% static 'scripts/list-info.js' %}"></script>

    <title>View {{list.name}} - Head2Head</title>
{% endblock %}
{% block main %}
    <main class="main-container">
        <div class="list-name">{{list.name}}</div>
        <div class="list-metadata">
            <div class="list-detail-container">
                <div class="important-details">
                    <a class="list-author-link" href="{% url 'view_profile' list.user.profile.slug %}">
                        <img src="{{list.user.profile.image.url}}" class="profile-picture user-image">
                        <div class="list-author">{{list.user.profile.username}}</div>
                    </a>
                    <div class="dot-separator">&middot;</div>
                    
                    <div class="list-detail-stat-value">{{list.num_things}} Things</div><div class="dot-separator">&middot;</div>
                    <div id="permission" class="list-detail-stat-value">{{list.get_permission_display}}</div><br>
                </div>
                {% if list.description %}
                <div class="list-description">{{list.description}}</div>
                {% endif %}
                <div class="list-details">
                    <div class="list-detail-stat-name">Comparisons Made:</div><div class="list-detail-stat-value">{{list.comparisons_made}} / {{list.comparisons_needed}} ({{ list.comparisons_made|div:list.comparisons_needed|mul:100|floatformat:2 }}%)</div><br>
                    <div class="list-detail-stat-name">Comparison Model:</div><div class="list-detail-stat-value">{{list.get_comparison_method_display }}</div><br>
                    <div class="list-detail-stat-name">Last Comparison:</div><div class="list-detail-stat-value">{{ list.last_updated|date:"F jS, Y"}} (*11 years ago)</div><br>
                    <div class="list-detail-stat-name">List Created:</div><div class="list-detail-stat-value">{{list.date_created|date:"F jS, Y"}} (*11 days ago)</div><br>
                </div>
                <div>
                    {% if can_rank %}
                        <a href="{% url 'list_rank' list.slug %}">
                            <div class="rank-button">Rank</div>
                        </a>
                        <a href="{% url 'list_copy' list.slug %}">
                            <div class="rank-button">Copy</div>
                        </a>
                    {% endif %}
                    {% if can_edit %}
                    <a href="{% url 'list_edit' list.slug %}">
                        <div class="edit-button">Edit</div>
                    </a>
                    {% endif %}
                </div> 
            </div>
            {% if list.image %}
                <div class="list-image-container">
                    <img class="list-image" src="{{list.image.url}}">
                </div>
            {% endif %}
        </div>
        <div class="multiple-highlight-container">
            <div class="highlight-container">
                <div class="highlight-title">Best 5 Things</div>
                <div class="highlight-five-things-group" id="js-top-five">
                    {% for thing, matchups in top_five %}
                    <div class="highlight-thing">
                        <span class="highlight-position-number"><span class="js-position-number">{{forloop.counter}}</span>.</span>
                        {% if thing.image %}
                            <div class="highlight-thing-name">{{thing.name}}</div>
                            <img class="highlight-thing-image" src="{{thing.image.url}}">
                        {% else %}
                            <div class="highlight-thing-name-only">{{thing.name}}</div>
                        {% endif %}
                        <div class="highlight-thing-record js-load-matchups">
                            <img class="W-win" src="{% static 'images/W-Win.png' %}"><div class="wins-losses-text">{{thing.wins}}</div><div class="record-dash"> -</div><img class="l-lose" src="{% static 'images/L-Lose.png' %}"><div class="wins-losses-text">{{thing.losses}}</div>
                            {% if thing.wins != 0 or thing.losses != 0 %}
                                <div class="past-matchup-sheet js-matchup-history">
                                    Loading Matchups...
                                </div>
                            {% endif %}
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
            <div class="highlight-container">
                <div class="highlight-title">Worst 5 Things</div>
                <div class="highlight-five-things-group" id="js-bottom-five">
                    {% for thing, matchups in bottom_five %}
                    <div class="highlight-thing">
                        <span class="highlight-position-number"><span class="js-position-number">{{list.num_things|sub:"5"|add:forloop.counter}}</span>.</span>
                        {% if thing.image %}
                            <div class="highlight-thing-name">{{thing.name}}</div>
                            <img class="highlight-thing-image" src="{{thing.image.url}}">
                        {% else %}
                            <div class="highlight-thing-name-only">{{thing.name}}</div>
                        {% endif %}
                        <div class="highlight-thing-record js-load-matchups">
                            <img class="W-win" src="{% static 'images/W-Win.png' %}"><div class="wins-losses-text">{{thing.wins}}</div><div class="record-dash"> -</div><img class="l-lose" src="{% static 'images/L-Lose.png' %}"><div class="wins-losses-text">{{thing.losses}}</div>
                            {% if thing.wins != 0 or thing.losses != 0 %}
                                <div class="past-matchup-sheet js-matchup-history">
                                    Loading Matchups...
                                </div>
                            {% endif %}
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>
        <div class="all-things-container">
            <div id="all-things-list" class="highlight-five-things-group" style="width: 810px;"></div>
        </div>
        <div style="display: flex; justify-content: center;">
            <div id="all-things-button" class="all-things-button">Load All Things</div>
        </div>
        
        <template id="empty-thing-box">
            <div id="thing-box" class="highlight-thing">
                <span class="highlight-position-number"><span class="js-position-number"></span>.</span>
                <!-- Do not change the indentation on this line. It messes with the styling -->
                <div id="thing-record" class="highlight-thing-record js-load-matchups"><img class="W-win" src="{% static 'images/W-Win.png' %}"><div class="wins-losses-text js-thing-wins"></div><div class="record-dash"> -</div><img class="l-lose" src="{% static 'images/L-Lose.png' %}"><div class="wins-losses-text js-thing-losses"></div>
                    <div class="past-matchup-sheet js-matchup-history">
                        Loading Matchups...
                    </div>
                </div>
            </div>
        </template>
        <template id="text-and-image">
            <div style="width: 492px;" class="highlight-thing-name js-thing-name"></div>
            <img class="highlight-thing-image js-thing-image" src="">
        </template>
        <template id="text-only">
            <div style="width: 580.5px;" class="highlight-thing-name-only js-thing-name-only"></div>
        </template>

        <template id="won-matchup">
            <div class="past-matchup">
                <img class="W-win" src="{% static 'images/W-Win.png' %}"> vs. <span class="js-opponent"></span>
                <span class="past-matchup-author js-matchup-username"></span>
            </div>
        </template>
        <template id="lost-matchup">
            <div class="past-matchup">
                <img class="l-lose" src="{% static 'images/L-Lose.png' %}"> vs. <span class="js-opponent"></span>
                <span class="past-matchup-author js-matchup-username"></span>
            </div>
        </template>

    </main>
{% endblock %}